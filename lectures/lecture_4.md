# Лекция 4

## Нормальная форма Хомского

### Df $G \in \textrm{CFG}$ имеет нормальную форму Хомского (ХНФ)

>$G \in G_\lambda$ и $\forall p \in G.P$ (кроме $S \rightarrow \lambda$) $p$ имеет вид $A \rightarrow BC$ или $A \rightarrow a$ для некоторых $A$, $B$ $\in G.\Gamma$ и $a \in \Sigma^*$

### Th О форме Хомского

> $$\forall G \in \textrm{CFG} \,\,\exists G' \textrm{ в ХНФ  } \, : \, G \overset{L}{=} G'$$ (1)

### Df Цикл в грамматике $G$

> Набор правил $A_1 \rightarrow A_2, A_2 \rightarrow A_3, …, A_{k-1} \rightarrow A_k ,A_k \rightarrow A_1 \subset G.P$  — цикл

### Lm о циклах в грамматике (2)

> $\forall G \in \textrm{CFG} \,\,\exists G' \textrm{CFG} \, : \, G \textrm{ не имеет циклов и } G \overset{L}{=} G'$

### Pf 2

> Возьмем некоторую $G = (\Sigma, \Gamma, P, S) \in \textrm{CFG}$. По теореме о $\lambda$-свободных грамматиках мы можем считать, что $G$ уже является $\lambda$-свободной.  
> Рассмотрим граф: его вершины — нетерминалы, а ребра — правила: $J = (\Gamma, \left\{uw \vert (u \rightarrow w) \in P \right\})$.  
> В таком графе нет петель, а циклы в грамматике соответствуют циклам в графе.
> В каждом цикле $C = \left\{A_1, A_2,…, A_n\right\}$ заменим все нетерминалы $A_i$ на некоторый $A_k \in C$ и получим соответствующее правило, которое (вместе с другими правилами, не образующими циклы) и образует необходимую ациклическую грамматику.  
> Путем махания руками показали, что такое преобразование эквивалентно. Полное доказательство есть в ШурЗаме на 93 странице.

### Pf 1

> Приведем алгоритм приведения некоторой КСГ $G$ в ХНФ:
>
>* По теореме о $\lambda$-свободной грамматике можно перейти от $G$ к эквивалентной ей $\lambda$-свободной $G_0$
>* Теперь для каждого правила вида $A \rightarrow \alpha, \, \alpha \neq \lambda$:
>   * Для каждого $b \in \alpha \cap \Sigma$ введем новый нетерминал $B$
>   * Добавим правило $B \rightarrow b$
>   * Заменим все вхождения $b$ в правых частях всех правил на $B$
>   * Полученную в результате грамматику назовем $G_1$. Очевидно, что такое преобразование будет эквивалентным.
>* Теперь нужно справиться с правилами вида $A \rightarrow A_1 \cdot A_2 \cdot … \cdot A_k, \, k>2$, для каждого такого правила:
>   * заменим все правило на следующий набор: $A \rightarrow A_1 \cdot A_1'$, $A_1' \rightarrow A_2 \cdot A_2'$, …, $A_{k-2}'\rightarrow A_{k-1} \cdot A_k$
>   * Такое преобразование тоже, очевидно, эквивалентно: просто заменили длинное правило на длинную цепочку правил по два нетерминала и получили новую грамматику $G_2$
>* Используем лемму о циклах и избавляемся от циклов в $G_2$, получаем $G_3$.
>* Теперь осталось избавиться от правил вида $A \rightarrow B$:
>   * Строим граф из всех правил такого вида: он будет направленным и ациклическим $\implies \exists B$ — сток (вершина с нулевой степенью исхода).
>   * В $G_3$ существует правило $p' = B \rightarrow \beta_1 \vert \beta_2 \vert … \vert \beta_m$
>   * Подставляем правую часть $p'$ везде, где использовался нетерминал $B$
>   * Повторяем предыдущие три шага пока есть еще правила вида $A \rightarrow B$.
>   * B итоге получаем $G_4$ в ХНФ.
>
> Все преобразования в этом алгоритме эквивалентны, значит мы доказали теорему путем построения и применения этого алгоритма.

### Пример приведения к ХНФ

$G$:
$$ S \rightarrow S(S) \vert \lambda $$
Еще один вариант генерации правильных скобочных последовательностей.  
Для начала нужно привести к $\lambda$-свободной грамматике $G_0$:
$$ S' \rightarrow \lambda $$
$$ S' \rightarrow S $$

$$ S \rightarrow SS \vert (S) \vert () $$
$S'$ теперь аксиома.

Теперь можно приводить к ХНФ:
Делаем первый шаг — убираем правила, в правой части которых есть терминалы вместе с нетерминалами и получаем $G_1$:
$$ S' \rightarrow \lambda \vert S $$

$$ S \rightarrow SS \vert LSR \vert LR $$

$$ L \rightarrow ( $$

$$ R \rightarrow \, ) $$

Делаем второй шаг — убираем правила, правая часть которых длиннее двух символов и получаем $G_2$:

$$ S' \rightarrow \lambda $$

$$ S' \rightarrow  S $$

$$ S \rightarrow SS \vert LA \vert LR $$

$$ A \rightarrow SR $$

$$ L \rightarrow ( $$

$$ R \rightarrow \, ) $$

Делаем третий шаг — убираем правила вида $A \rightarrow B$ (такое только одно) и получаем $G_4$ в ХНФ:

$$ S' \rightarrow \lambda $$

$$ S' \rightarrow S'S' \vert LA \vert LR $$

$$ A \rightarrow S'R $$

$$ L \rightarrow ( $$

$$ R \rightarrow \, ) $$

## Теорема о накачке

### Th о накачке
> $$\forall L \in \textrm{CFL} \exists m, n \in \natnums: \\ \forall w \in L \, : \, \vert w\vert > n \\ w = xuzvy$$
> где
> $$ \vert uv \vert > 0 \\ \vert uzv \vert < m $$
> выполняется
> $$ \forall k \geq 0 \,\, xu^kzv^ky \in L$$
**TODO** Доказательство большое и требует рисования треугольных деревьев, не совсем понятно, как это провернуть тут. К тому же Шур на лекции его не давал, так что черт его знает, нужно ли писать **TODO**  
Доказательство можно посмотреть в ШурЗаме на странице 71.


